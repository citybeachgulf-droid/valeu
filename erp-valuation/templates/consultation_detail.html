{% extends 'base.html' %}
{% set title = 'ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø© #' ~ c.id %}

{% block navbar %}
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="{{ url_for('consultations_list') }}">Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø§Øª</a>
  </div>
</nav>
{% endblock %}

{% block content %}
<div class="container my-4">
  <div class="card">
    <div class="card-body">
      <div class="d-flex justify-content-between align-items-center">
        <h5 class="card-title">#{{ c.id }} Â· {{ c.consultation_type }}</h5>
        <span class="badge bg-{{ 'success' if c.status=='Completed' else ('warning' if c.status=='In Progress' else 'secondary') }}">{{ c.status }}</span>
      </div>
      <hr>
      <div class="row">
        <div class="col-12 col-md-6">
          <p><strong>Ø§Ù„Ù…Ø´Ø±ÙˆØ¹:</strong> {{ project.name if project else '-' }}</p>
          <p><strong>Ø§Ù„Ø¹Ù…ÙŠÙ„:</strong> {{ client.name if client else '-' }}</p>
          <p><strong>Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±ÙŠ:</strong> {{ c.consultant_name or '-' }}</p>
          <p><strong>Ø§Ù„ÙØªØ±Ø©:</strong> {{ c.start_date or '' }}{% if c.end_date %} â†’ {{ c.end_date }}{% endif %}</p>
        </div>
        <div class="col-12 col-md-6">
          <p><strong>Ø§Ù„ØªÙƒÙ„ÙØ©:</strong> {{ '%.2f'|format(c.cost or 0) }}</p>
          <p><strong>Ø£Ù†Ø´Ø¦Øª ÙÙŠ:</strong> {{ c.created_at.strftime('%Y-%m-%d %H:%M') if c.created_at else '' }}</p>
          <p><strong>Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«:</strong> {{ c.updated_at.strftime('%Y-%m-%d %H:%M') if c.updated_at else '' }}</p>
        </div>
      </div>
      <hr>
      <p class="mb-0"><strong>Ø§Ù„ÙˆØµÙ:</strong></p>
      <div class="border rounded p-3 bg-light">{{ c.description or '-' }}</div>
    </div>
  </div>

  <div class="mt-3 d-flex gap-2">
    <a class="btn btn-outline-secondary" href="{{ url_for('consulting_dashboard.dashboard_home') }}">ğŸ§  Ù„ÙˆØ­Ø© Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø§Øª</a>
    <a class="btn btn-primary" href="{{ url_for('consultations_edit', cid=c.id) }}">ØªØ¹Ø¯ÙŠÙ„</a>
    {% if session.get('role') == 'manager' %}
    <form method="post" action="{{ url_for('consultations_delete', cid=c.id) }}" onsubmit="return confirm('Ø­Ø°Ù Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø©ØŸ');">
      <button class="btn btn-danger">Ø­Ø°Ù</button>
    </form>
    {% endif %}
    {% if session.get('role') in ['manager','finance'] and (c.cost or 0) > 0 %}
    <form method="post" action="{{ url_for('consultations_invoice', cid=c.id) }}">
      <button class="btn btn-success">Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø©</button>
    </form>
    {% endif %}
  </div>
</div>
{% endblock %}
