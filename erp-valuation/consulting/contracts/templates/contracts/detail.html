{% extends 'base.html' %}
{% block content %}
<div class="container py-4">
  <div class="d-flex align-items-center justify-content-between mb-3">
    <h3 class="mb-0">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù‚Ø¯ - {{ contract.contract_number }}</h3>
    <a class="btn btn-secondary" href="{{ url_for('consulting_contracts.list_contracts') }}">Ø±Ø¬ÙˆØ¹</a>
  </div>

  {% if contract.is_near_expiry() %}
    <div class="alert alert-warning">âš ï¸ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù‚Ø¯ ÙŠÙ†ØªÙ‡ÙŠ Ø®Ù„Ø§Ù„ {{ contract.days_to_expiry() }} ÙŠÙˆÙ….</div>
  {% endif %}

  <div class="card mb-3">
    <div class="card-body">
      <div class="row g-3">
        <div class="col-md-6">
          <div><strong>Ø§Ù„Ù…Ø´Ø±ÙˆØ¹:</strong> {{ contract.project.name if contract.project else '-' }}</div>
          <div><strong>Ø§Ù„Ø¹Ù…ÙŠÙ„:</strong> {{ contract.client.name if contract.client else '-' }}</div>
          <div><strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> {{ contract.status }}</div>
          <div><strong>Ø§Ù„Ù‚ÙŠÙ…Ø©:</strong> {{ '%.2f'|format(contract.value) if contract.value is not none else '-' }}</div>
        </div>
        <div class="col-md-6">
          <div><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡:</strong> {{ contract.start_date.strftime('%Y-%m-%d') if contract.start_date else '-' }}</div>
          <div><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡:</strong> {{ contract.end_date.strftime('%Y-%m-%d') if contract.end_date else '-' }}</div>
          <div><strong>Ø£Ø¶ÙŠÙØª ÙÙŠ:</strong> {{ contract.created_at.strftime('%Y-%m-%d') if contract.created_at else '-' }}</div>
        </div>
        <div class="col-12">
          <div><strong>Ø´Ø±ÙˆØ· Ø§Ù„Ø¯ÙØ¹:</strong></div>
          <div class="text-muted">{{ contract.payment_terms or '-' }}</div>
        </div>
        <div class="col-12">
          <div><strong>Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</strong></div>
          <div class="text-muted">{{ contract.notes or '-' }}</div>
        </div>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-body">
      <h5 class="card-title">Ù…Ù„Ù Ø§Ù„Ø¹Ù‚Ø¯ (PDF)</h5>
      {% if contract.file_path %}
        <p>
          <a class="btn btn-outline-primary" target="_blank" href="{{ url_for('uploaded_file', filename=contract.file_path) }}">ğŸ“„ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù</a>
          <a class="btn btn-outline-secondary" href="{{ url_for('download_local_file', filename=contract.file_path) }}">â¬‡ï¸ ØªÙ†Ø²ÙŠÙ„</a>
        </p>
      {% else %}
        <p class="text-muted">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù„Ù Ù…Ø±ÙÙ‚.</p>
      {% endif %}

      <form class="mt-3" method="post" enctype="multipart/form-data" action="{{ url_for('consulting_contracts.upload_contract_file', contract_id=contract.id) }}">
        <div class="row g-2 align-items-center">
          <div class="col-md-6">
            <input type="file" name="file" accept="application/pdf" class="form-control" required>
          </div>
          <div class="col-md-3 d-grid">
            <button class="btn btn-primary" type="submit">Ø±ÙØ¹/Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù…Ù„Ù</button>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
