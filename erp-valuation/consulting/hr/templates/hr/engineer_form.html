{% extends 'base.html' %}

{% block content %}
<style>
/* ===== إعداد الاتجاه والخط ===== */
body {
  direction: rtl;
  text-align: right;
  font-family: 'Tajawal', sans-serif;
}

/* ===== تحسين تصميم الصفحة ===== */
.container {
  max-width: 1100px;
}

.card, .btn, .form-control, .form-select {
  border-radius: 10px !important;
}

h3 {
  font-weight: 600;
  color: #4a148c;
}

label.form-label {
  font-weight: 500;
  color: #333;
}

.btn-primary {
  background-color: #6f42c1;
  border: none;
}
.btn-primary:hover {
  background-color: #5a32a3;
}

.btn-outline-secondary:hover {
  background-color: #f8f9fa;
  color: #000;
}

.alert-light {
  background-color: #fdfcff;
}

</style>

<!-- استدعاء خط تاجوال -->
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;600&display=swap" rel="stylesheet">

<div class="container py-4">
  <div class="d-flex flex-wrap align-items-start justify-content-between gap-3 mb-4">
    <div>
      <h3 class="mb-1">
        {% if mode == 'create' %}
          إضافة مهندس جديد
        {% else %}
          تعديل بيانات المهندس
        {% endif %}
      </h3>
      <p class="text-muted small mb-0">
        {% if mode == 'create' %}
          قم بإدخال بيانات المهندس الجديد لإضافته إلى قاعدة بيانات المكتب.
        {% else %}
          يمكنك تعديل بيانات المهندس وحفظ التغييرات أدناه.
        {% endif %}
      </p>
    </div>
    <div class="d-flex flex-wrap gap-2">
      {% if engineer %}
      <a class="btn btn-outline-secondary" href="{{ url_for('consulting_hr.engineer_detail', engineer_id=engineer.id) }}">عرض ملف المهندس</a>
      {% endif %}
      <a class="btn btn-outline-secondary" href="{{ url_for('consulting_hr.list_engineers') }}">قائمة المهندسين</a>
      <a class="btn btn-outline-secondary" href="{{ url_for('consulting_hr.dashboard') }}">لوحة HR</a>
    </div>
  </div>

  <form method="post" class="row g-3" novalidate>
    <!-- الاسم الكامل -->
    <div class="col-md-6">
      <label class="form-label">الاسم الكامل</label>
      <input type="text" class="form-control {% if form_errors.get('name') %}is-invalid{% endif %}" name="name" value="{{ form_values.name }}" required>
      {% if form_errors.get('name') %}<div class="invalid-feedback d-block">{{ form_errors.get('name') }}</div>{% endif %}
    </div>

    <!-- التخصص -->
    <div class="col-md-3">
      <label class="form-label">التخصص</label>
      <select class="form-select {% if form_errors.get('specialty') %}is-invalid{% endif %}" name="specialty" required>
        <option value="">-- اختر التخصص --</option>
        {% for sp in ENGINEER_SPECIALTIES %}
        <option value="{{ sp }}" {% if form_values.specialty==sp %}selected{% endif %}>{{ sp }}</option>
        {% endfor %}
      </select>
      {% if form_errors.get('specialty') %}<div class="invalid-feedback d-block">{{ form_errors.get('specialty') }}</div>{% endif %}
    </div>

    <!-- الحالة -->
    <div class="col-md-3">
      <label class="form-label">الحالة</label>
      <select class="form-select {% if form_errors.get('status') %}is-invalid{% endif %}" name="status">
        {% for st in ENGINEER_STATUSES %}
        <option value="{{ st }}" {% if form_values.status==st %}selected{% endif %}>{{ st }}</option>
        {% endfor %}
      </select>
      {% if form_errors.get('status') %}<div class="invalid-feedback d-block">{{ form_errors.get('status') }}</div>{% endif %}
    </div>

    <!-- رقم الهاتف -->
    <div class="col-md-4">
      <label class="form-label">رقم الهاتف</label>
      <input type="text" class="form-control" name="phone" value="{{ form_values.phone }}">
    </div>

    <!-- البريد الإلكتروني -->
    <div class="col-md-4">
      <label class="form-label">البريد الإلكتروني</label>
      <input type="email" class="form-control {% if form_errors.get('email') %}is-invalid{% endif %}" name="email" value="{{ form_values.email }}">
      {% if form_errors.get('email') %}<div class="invalid-feedback d-block">{{ form_errors.get('email') }}</div>{% endif %}
    </div>

    <!-- تاريخ الانضمام -->
    <div class="col-md-4">
      <label class="form-label">تاريخ الانضمام</label>
      <input type="date" class="form-control {% if form_errors.get('join_date') %}is-invalid{% endif %}" name="join_date" value="{{ form_values.join_date }}">
      {% if form_errors.get('join_date') %}<div class="invalid-feedback d-block">{{ form_errors.get('join_date') }}</div>{% endif %}
    </div>

    <!-- ملاحظة -->
    <div class="col-12">
      <div class="alert alert-light border small mb-0">
        <strong>ملاحظة:</strong> يمكنك تعديل بيانات المهندس لاحقًا من خلال لوحة التحكم الخاصة بقسم الموارد البشرية.
      </div>
    </div>

    <!-- الأزرار -->
    <div class="col-12 d-flex justify-content-between align-items-center mt-3">
      <a class="btn btn-outline-secondary" href="{{ url_for('consulting_hr.list_engineers') }}">رجوع</a>
      <button class="btn btn-primary" type="submit">
        {% if mode == 'create' %}حفظ المهندس{% else %}تحديث البيانات{% endif %}
      </button>
    </div>
  </form>
</div>
{% endblock %}
