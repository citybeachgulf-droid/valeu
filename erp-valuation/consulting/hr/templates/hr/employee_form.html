{% extends 'base.html' %}

{% block content %}
<style>
/* ===== ????? ??????? ????? ===== */
body {
  direction: rtl;
  text-align: right;
  font-family: 'Tajawal', sans-serif;
}

.container {
  max-width: 1200px;
}

.card, .btn, .form-control, .form-select {
  border-radius: 10px !important;
}

h3 {
  font-weight: 600;
  color: #4a148c;
}

label.form-label {
  font-weight: 500;
  color: #333;
}

.btn-primary {
  background-color: #6f42c1;
  border: none;
}
.btn-primary:hover {
  background-color: #5a32a3;
}

.btn-outline-secondary:hover {
  background-color: #f8f9fa;
  color: #000;
}

.alert-light {
  background-color: #fdfcff;
}
</style>

<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;600&display=swap" rel="stylesheet">

<div class="container py-4">
  <div class="d-flex flex-wrap align-items-start justify-content-between gap-3 mb-4">
    <div>
      <h3 class="mb-1">
        {% if mode == 'create' %}
          ????? ???? ????
        {% else %}
          ????? ?????? ??????
        {% endif %}
      </h3>
      <p class="text-muted small mb-0">
        {% if mode == 'create' %}
          ?? ?????? ?????? ?????? ?????? ??????? ??? ????? ?????? ??????.
        {% else %}
          ????? ????? ?????? ?????? ???? ????????? ?????.
        {% endif %}
      </p>
    </div>
    <div class="d-flex flex-wrap gap-2">
      {% if employee %}
      <a class="btn btn-outline-secondary" href="{{ url_for('consulting_hr.employee_detail', employee_id=employee.id) }}">??? ??? ??????</a>
      {% endif %}
      <a class="btn btn-outline-secondary" href="{{ url_for('consulting_hr.list_employees') }}">????? ????????</a>
      <a class="btn btn-outline-secondary" href="{{ url_for('consulting_hr.dashboard') }}">???? HR</a>
    </div>
  </div>

  <form method="post" class="row g-3" novalidate>
    <!-- ??????? ?????? -->
    <div class="col-12">
      <h5 class="border-bottom pb-2 mb-3">??????? ??????</h5>
    </div>

    <div class="col-md-4">
      <label class="form-label">????? ???????</label>
      <input type="text" class="form-control {% if form_errors.get('employee_number') %}is-invalid{% endif %}" name="employee_number" value="{{ form_values.employee_number or '' }}">
      {% if form_errors.get('employee_number') %}<div class="invalid-feedback d-block">{{ form_errors.get('employee_number') }}</div>{% endif %}
    </div>

    <div class="col-md-4">
      <label class="form-label">????? ????? <span class="text-danger">*</span></label>
      <input type="text" class="form-control {% if form_errors.get('first_name') %}is-invalid{% endif %}" name="first_name" value="{{ form_values.first_name or '' }}" required>
      {% if form_errors.get('first_name') %}<div class="invalid-feedback d-block">{{ form_errors.get('first_name') }}</div>{% endif %}
    </div>

    <div class="col-md-4">
      <label class="form-label">????? ??????</label>
      <input type="text" class="form-control" name="middle_name" value="{{ form_values.middle_name or '' }}">
    </div>

    <div class="col-md-4">
      <label class="form-label">????? ?????? <span class="text-danger">*</span></label>
      <input type="text" class="form-control {% if form_errors.get('last_name') %}is-invalid{% endif %}" name="last_name" value="{{ form_values.last_name or '' }}" required>
      {% if form_errors.get('last_name') %}<div class="invalid-feedback d-block">{{ form_errors.get('last_name') }}</div>{% endif %}
    </div>

    <div class="col-md-4">
      <label class="form-label">????? ????????</label>
      <input type="text" class="form-control" name="arabic_name" value="{{ form_values.arabic_name or '' }}">
    </div>

    <div class="col-md-4">
      <label class="form-label">????? ???????</label>
      <input type="date" class="form-control" name="date_of_birth" value="{{ form_values.date_of_birth or '' }}">
    </div>

    <div class="col-md-4">
      <label class="form-label">?????</label>
      <select class="form-select" name="gender">
        <option value="">-- ???? --</option>
        <option value="???" {% if form_values.gender == '???' %}selected{% endif %}>???</option>
        <option value="????" {% if form_values.gender == '????' %}selected{% endif %}>????</option>
      </select>
    </div>

    <!-- ??????? ??????? -->
    <div class="col-12 mt-4">
      <h5 class="border-bottom pb-2 mb-3">??????? ???????</h5>
    </div>

    <div class="col-md-6">
      <label class="form-label">?????? ??????????</label>
      <input type="email" class="form-control {% if form_errors.get('email') %}is-invalid{% endif %}" name="email" value="{{ form_values.email or '' }}">
      {% if form_errors.get('email') %}<div class="invalid-feedback d-block">{{ form_errors.get('email') }}</div>{% endif %}
    </div>

    <div class="col-md-3">
      <label class="form-label">??????</label>
      <input type="text" class="form-control" name="phone" value="{{ form_values.phone or '' }}">
    </div>

    <div class="col-md-3">
      <label class="form-label">??????</label>
      <input type="text" class="form-control" name="mobile" value="{{ form_values.mobile or '' }}">
    </div>

    <div class="col-md-4">
      <label class="form-label">???????</label>
      <textarea class="form-control" name="address" rows="2">{{ form_values.address or '' }}</textarea>
    </div>

    <div class="col-md-4">
      <label class="form-label">???????</label>
      <input type="text" class="form-control" name="city" value="{{ form_values.city or '' }}">
    </div>

    <div class="col-md-4">
      <label class="form-label">??????</label>
      <input type="text" class="form-control" name="country" value="{{ form_values.country or '' }}">
    </div>

    <!-- ?????? ??????? -->
    <div class="col-12 mt-4">
      <h5 class="border-bottom pb-2 mb-3">?????? ???????</h5>
    </div>

    <div class="col-md-4">
      <label class="form-label">?????</label>
      <select class="form-select {% if form_errors.get('department_id') %}is-invalid{% endif %}" name="department_id">
        <option value="">-- ???? ????? --</option>
        {% for dept in departments %}
        <option value="{{ dept.id }}" {% if form_values.department_id|string == dept.id|string %}selected{% endif %}>{{ dept.name }}</option>
        {% endfor %}
      </select>
      {% if form_errors.get('department_id') %}<div class="invalid-feedback d-block">{{ form_errors.get('department_id') }}</div>{% endif %}
    </div>

    <div class="col-md-4">
      <label class="form-label">?????? ???????</label>
      <input type="text" class="form-control" name="job_title" value="{{ form_values.job_title or '' }}">
    </div>

    <div class="col-md-4">
      <label class="form-label">??????</label>
      <input type="text" class="form-control" name="position" value="{{ form_values.position or '' }}">
    </div>

    <div class="col-md-4">
      <label class="form-label">??? ???????</label>
      <select class="form-select" name="employment_type">
        <option value="">-- ???? --</option>
        {% for et in EMPLOYMENT_TYPES %}
        <option value="{{ et }}" {% if form_values.employment_type == et %}selected{% endif %}>{{ et }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="col-md-4">
      <label class="form-label">????? ????????</label>
      <input type="date" class="form-control" name="join_date" value="{{ form_values.join_date or '' }}">
    </div>

    <div class="col-md-4">
      <label class="form-label">??????</label>
      <select class="form-select {% if form_errors.get('status') %}is-invalid{% endif %}" name="status">
        {% for st in EMPLOYEE_STATUSES %}
        <option value="{{ st }}" {% if form_values.status == st %}selected{% endif %}>{{ st }}</option>
        {% endfor %}
      </select>
      {% if form_errors.get('status') %}<div class="invalid-feedback d-block">{{ form_errors.get('status') }}</div>{% endif %}
    </div>

    <!-- ??????? ?????? -->
    <div class="col-12 mt-4">
      <h5 class="border-bottom pb-2 mb-3">??????? ??????</h5>
    </div>

    <div class="col-md-6">
      <label class="form-label">?????? ???????</label>
      <input type="number" step="0.01" class="form-control" name="base_salary" value="{{ form_values.base_salary or '' }}">
    </div>

    <div class="col-md-6">
      <label class="form-label">??????</label>
      <select class="form-select" name="currency">
        <option value="SAR" {% if form_values.currency == 'SAR' or not form_values.currency %}selected{% endif %}>SAR</option>
        <option value="USD" {% if form_values.currency == 'USD' %}selected{% endif %}>USD</option>
        <option value="EUR" {% if form_values.currency == 'EUR' %}selected{% endif %}>EUR</option>
      </select>
    </div>

    <div class="col-12">
      <label class="form-label">???????</label>
      <textarea class="form-control" name="notes" rows="3">{{ form_values.notes or '' }}</textarea>
    </div>

    <!-- ??????? -->
    <div class="col-12 d-flex justify-content-between align-items-center mt-3">
      <a class="btn btn-outline-secondary" href="{% if employee %}{{ url_for('consulting_hr.employee_detail', employee_id=employee.id) }}{% else %}{{ url_for('consulting_hr.list_employees') }}{% endif %}">????</a>
      <button class="btn btn-primary" type="submit">
        {% if mode == 'create' %}??? ??????{% else %}????? ????????{% endif %}
      </button>
    </div>
  </form>
</div>
{% endblock %}
